# Typed Concurrent Functional Programming with Channels, Actors, and Sessions

**Typed Concurrent Functional Programming with Channels, Actors, and Sessions** (2019)

Simon Fowler

- https://simonjf.com/writing/phd-thesis.pdf

<br>
<br>

---

## Abstract

단일 스레드 애플리케이션을 작성하는 시대는 끝났다. 확장 가능한 애플리케이션을 개발하기 위해서는 병행성과 병렬성을 활용해야 한다. <br>
그러나 병행성과 병렬성을 도입하는 것은 쉽지 않다. 단순하게 구현한 병행 코드는 경쟁 조건(race condition)이나 데드락(deadlock)과 같은 문제에 취약하다.
여기에 분산 환경이 더해지면 실패 가능성 등 추가적인 문제가 발생한다.

이러한 병행 프로그래밍의 문제를 해결하기 위해,  <br>
언어 설계자들은 **통신 중심 프로그래밍 언어**(communication-centric programming languages)를 제안해왔다.  <br>
이들은 메모리를 공유하지 않고 **명시적인 메시지 전달**을 통해 통신하는 경량 프로세스(lightweight process)를 제공한다.  <br>
본 논문은 **타입 기반 통신 중심 함수형 프로그래밍 언어**에 초점을 맞추며,  <br>
타입 시스템을 이용해 병행 프로그램의 실행 중 행위에 대한 정적 보장을 제공하고자 한다. <br>

본 연구는 두 가지 흐름을 다룬다.  <br>
첫째, **타입화된 채널 기반 언어와 액터 기반 언어 간의 관계**를 탐구하고,  <br>
둘째, **비동기성, 예외 처리, 세션 타입의 통합**을 함수형 언어에 구현하는 것이다. <br>

첫 번째 흐름에서는 Go와 같은 **채널 기반 언어**, Erlang과 같은 **액터 모델 기반 언어**를  <br>
각각 단순형 타입의 동시 λ-계산법인 λch, λact로 정제하고, 양자 간의 **타입 및 의미론 보존 변환**을 정의한다.  <br>
이를 통해 두 모델 간의 혼란을 정리하고, **타입 매개 액터(type-parameterised actor)** 구현의 이론적 기반을 마련하며,  <br>
채널 기반 언어에서 액터를 흉내 내는 프레임워크의 이론적 근거도 제공한다.  <br>

또한, 핵심 계산법 확장을 통해 액터 동기화가 채널을 액터로 변환하는 과정을 단순화시키며,  <br>
Erlang의 선택 수신(selective receive) 메커니즘도 특수한 문법 없이 구현 가능함을 보인다. <br>

두 번째 흐름에서는 세션 타입, 비동기성, 예외 처리를 함수형 언어에서 통합한다.  <br>
**세션 타입**은 통신 채널의 행위에 대한 타입 시스템으로, 프로토콜 준수를 **정적으로 검증**할 수 있게 해준다.  <br>
본 논문에서는 예외 처리와 비동기 세션 타입을 통합한 최초의 함수형 언어인 **Exceptional GV**를 제안하고,  <br>
이 언어가 보존성, 전역 진행성(global progress), 결정성(confluence), 종료성(termination)을 만족함을 증명한다.  <br>

실용적 적용으로는, **Links** 웹 프로그래밍 언어에 예외 처리를 확장 구현하여,  <br>
세션 타입을 포함한 언어에서 **예외 처리를 지원하는 최초 사례**를 제시한다.  <br>
이를 통해 이 접근법이 실제 웹 프로그래밍 환경에서도 유용함을 보이고,  <br>
예로 **2단계 인증 워크플로우**와 **채팅 애플리케이션**을 구현한다. <br>

 <br>
  <br>
  
---

## Lay Summary

현대의 주류 프로그래밍 언어는 병행 애플리케이션을 작성하기에 적합하지 않다.  <br>
이는 여러 스레드(동시에 실행되는 코드 단위)가 공유 자원을 사용할 때 발생하는 상호작용을 개발자가 직접 신경 써야 하기 때문이다. <br>

병행 코드에서 전형적인 오류 예로는 은행 계좌를 생각해볼 수 있다.  <br>
초기 잔고가 £100인 상태에서, 스레드 1이 £60을 입금하고 스레드 2가 £50을 출금하려고 한다고 가정하자. 기대 결과는 £110이어야 한다.  <br>
그러나 두 스레드가 동시에 £100을 읽고 각각 연산을 수행하면, 마지막에 어떤 스레드가 기록하느냐에 따라 £160 또는 £50이 될 수 있다.  <br>
이는 **경쟁 조건(race condition)** 의 대표적인 예시이다. <br>

이 문제를 해결하려면, 자원이 갱신되는 동안 **오직 하나의 스레드만 자원에 접근**하도록 해야 하며,   <br>
이를 위해 **락(lock)** 이라는 메커니즘을 사용한다.  <br>
하지만 락은 조합하거나 예측하기 어렵고, **데드락(deadlock)** 과 같은 문제로 이어질 수 있다.  <br>
이에 대한 대안으로, 본 논문에서는 **메시지 전달 기반 병행성(message-passing concurrency)** 을 고려한다.  <br>
이 모델에서는 경량 프로세스들이 자원을 직접 공유하지 않고, **명시적으로 메시지를 주고받으며 통신**한다. <br>

하지만 메시지 전달 방식도 완벽한 해법은 아니다.  <br>
잘못된 메시지를 보내거나 응답이 오지 않는 메시지를 기다리면 문제가 발생할 수 있다.  <br>
즉, 메시지 기반 프로그램이 정상적으로 작동하려면 **비공식적인 통신 프로토콜을 개발자가 엄격히 준수**해야 한다. <br>

이 논문에서는 병행 함수형 프로그래밍 언어에서 데이터 타입 개념을 메시지 전달 구조에 적용한다.  <br>
데이터 타입을 이용하면 프로그램이 실행되기 전에도 오류를 방지할 수 있다.  <br>
예를 들어, 정수 `5`와 불리언 `true`를 곱하려 하면 컴파일 오류가 발생하듯 말이다. <br>

논문의 첫 번째 부분에서는 **채널 기반 언어와 액터 기반 언어의 수학적 모델**을 정제하고, 서로 에뮬레이션 가능함을 보여준다.  <br>
이를 통해 두 모델 간의 혼동을 해소하고, 액터에 타입을 부여하는 데 따르는 어려움을 구체적으로 밝힌다. <br>

두 번째 부분에서는 **세션 타입과 예외 처리의 통합**을 다룬다.  <br>
세션 타입은 프로토콜을 타입에 직접 표현할 수 있는 강력한 타입 시스템이지만,   <br>
대부분의 언어는 **실패나 예외 상황**을 다루지 못해 실제 적용에 한계가 있었다.  <br>
본 논문에서는 이를 부드럽게 통합한 핵심 언어를 설계하고,   <br>
이를 웹 언어 **Links**에 구현함으로써 **실제 웹 프로그래밍에 세션 타입을 적용한 첫 사례**를 제시한다. <br>
